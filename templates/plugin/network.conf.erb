<Plugin network>
<% @servers.sort.each do |name,params| -%>
<% if @collectd_version and (scope.function_versioncmp([collectd_version, '4.7']) >= 0) -%>
  <Server "<%= name %>" "<%= params['port'] %>">
<% if params['securitylevel'] -%>
    SecurityLevel "<%= params['securitylevel'] %>"
<% end -%>
<% if params['username'] -%>
    Username "<%= params['username'] %>"
<% end -%>
<% if params['password'] -%>
    Password "<%= params['password'] %>"
<% end -%>
<% if params['interface'] -%>
    Interface "<%= params['interface'] %>"
<% end %>
  </Server>
<% else -%>
  Server "<%= name %>" "<%= params['port'] %>"
<% end -%>
<% end -%>
<% @listeners.sort.each do |name,params| -%>
<% if @collectd_version and (scope.function_versioncmp([collectd_version, '4.7']) >= 0) -%>
  <Listen "<%= name %>" "<%= params['port'] %>">
<% if params['securitylevel'] -%>
    SecurityLevel "<%= params['securitylevel'] %>"
<% end -%>
<% if params['authfile'] -%>
    AuthFile "<%= params['authfile'] %>"
<% end -%>
<% if params['interface'] -%>
    Interface "<%= params['interface'] %>"
<% end %>
  </Listen>
<% else -%>
  Listen "<%= name %>" "<%= params['port'] %>"
<% end -%>
<% end -%>
<% if @timetolive -%>
  TimeToLive <%= @timetolive %>
<% end -%>
<% if @maxpacketsize -%>
  MaxPacketSize <%= @maxpacketsize %>
<% end -%>
<% if @forward -%>
  Forward "<%= @forward %>"
<% end -%>
<% if @reportstats -%>
  ReportStats "<%= @reportstats %>"
<% end -%>
</Plugin>
